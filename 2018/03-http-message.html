<!DOCTYPE html><html lang="zh-Hans"><head><!--[if IE]><style>body{display:none;}</style><script>alert('IE浏览器下无法展示效果，请更换浏览器！');var headNode=document.getElementsByTagName('head')[0];var refresh=document.createElement('meta');refresh.setAttribute('http-equiv','Refresh');refresh.setAttribute('Content','0; url=http://outdatedbrowser.com/');headNode.appendChild(refresh);</script><![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="鱼の乐"><meta name="shenma-site-verification" content="cd3048846de29809263b063b8e307624_1527169631"><meta name="360-site-verification" content="2d95e707197a9f8b2936ef16f299d4ee"><meta name="sogou_site_verification" content="ZdMIkaFR8c"><meta name="description" content="了解 request 和 response 的报文结构，以及常见首部的作用和浏览器的缓存机制"><meta name="keywords" content="http 扩展阅读,网络"><meta property="og:type" content="article"><meta property="og:title" content="HTTP Message"><meta property="og:url" content="https://blog.wangriyu.wang/2018/03-http-message.html"><meta property="og:site_name" content="Wangriyu’s Blog"><meta property="og:description" content="了解 request 和 response 的报文结构，以及常见首部的作用和浏览器的缓存机制"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:image" content="https://blog.wangriyu.wang/img/loading.gif"><meta property="og:updated_time" content="2018-07-29T04:27:21.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="HTTP Message"><meta name="twitter:description" content="了解 request 和 response 的报文结构，以及常见首部的作用和浏览器的缓存机制"><meta name="twitter:image" content="https://blog.wangriyu.wang/img/loading.gif"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="shortcut icon" href="/favicon.ico"><link href="//src.wangriyu.wang/lib/fancybox/jquery.fancybox.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><title>HTTP Message | Wangriyu’s Blog</title><script src="//src.wangriyu.wang/lib/jquery/jquery.min.js"></script><link href="//src.wangriyu.wang/lib/font-awesome/css/font-awesome.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/aos/aos.js"></script><script>var yiliaConfig={fancybox:!0,isHome:!1,isPost:!0,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"//src.wangriyu.wang/lib/fancybox/jquery.fancybox.min.js",search:!0}</script><script>yiliaConfig.jquery_ui=[!1]</script><script>yiliaConfig.rootUrl="/"</script><link rel="stylesheet" href="/css/prism-a11y-dark.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><link rel="stylesheet" href="/css/prism-a11y-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head></html><body><div id="container"><div class="left-col"><div class="backImg"><img src="//src.wangriyu.wang/images/blog/yule.jpg" width="312" height="330px"></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="//src.wangriyu.wang/images/blog/avatar.jpg"></a><hgroup><h1 class="header-author"><a href="/">鱼の乐</a></h1></hgroup><p class="header-subtitle">子非鱼，安知鱼之乐也！</p><form id="search-form"><input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"> <i class="fa fa-times" onclick="resetSearch()"></i></form><div id="local-search-result"></div><p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>目标</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="//home.wangriyu.wang">主页</a></li><li><a href="/archives/">归档</a></li><li><a href="/pages/waterFallAlbum">相册</a></li><li><a href="/pages/resume">简历</a></li><li><a href="/tags/">标签云</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa 掘金" href="https://juejin.im/user/58c3744bda2f605609683d66" title="掘金"></a> <a class="fa GitHub" href="https://github.com/wangriyu" title="GitHub"></a> <a class="fa RSS" href="/atom.xml" title="RSS"></a> <a class="fa 知乎" href="https://www.zhihu.com/people/clownduo/activities" title="知乎"></a> <a class="fa CSDN" href="https://blog.csdn.net/i929664292" title="CSDN"></a> <a class="fa jianshu" href="https://www.jianshu.com/u/7a8c5ba0b316" title="jianshu"></a> <a class="fa Facebook" href="https://www.facebook.com/riyu.wang.7" title="Facebook"></a> <a class="fa Twitter" href="https://twitter.com/wangriyu" title="Twitter"></a></ul><ul class="social"><div class="donateIcon-position"><p style="display:block"><a class="donateIcon" href="javascript:void(0)" onmouseout='var qr=document.getElementById("donate");qr.style.display="none"' onmouseenter='var qr=document.getElementById("donate");qr.style.display="block"'>赏</a></p><div id="donate"><img id="multipay" src="//src.wangriyu.wang/images/blog/multipay.png" width="250px" alt="鱼の乐 Multipay"><div class="triangle"></div></div></div></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Alerting/">Alerting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Aplayer/">Aplayer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CGO/">CGO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Copy/">Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/">ELK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GC/">GC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/">Golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Grafana/">Grafana</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/">Jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Log/">Log</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-存储扩展/">Mac 存储扩展</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UEFI-GPT/">UEFI&GPT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yelee/">Yelee</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dart/">dart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftp/">ftp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go-源码/">go 源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http-扩展阅读/">http 扩展阅读</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaScript/">javaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/libc/">libc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/masm/">masm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nextcloud/">nextcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pprof/">pprof</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rEFInd-引导美化/">rEFInd 引导美化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/root/">root</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win10-Ubuntu-双系统/">win10&Ubuntu 双系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/三阶段提交/">三阶段提交</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/两阶段提交/">两阶段提交</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/个人网盘/">个人网盘</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分享/">分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式理论/">分布式理论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/刷机/">刷机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/哈希/">哈希</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/应用/">应用</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/技巧/">技巧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/插件/">插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树/">树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器/">浏览器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器本地存储/">浏览器本地存储</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深入理解计算机/">深入理解计算机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"><a class="main-nav-link switch-friends-link" href="https://github.com/TechCatsLab">TechCatsLab</a> <a class="main-nav-link switch-friends-link" href="https://yangchenglong11.github.io">YangChengLong</a> <a class="main-nav-link switch-friends-link" href="https://jsharkc.github.io">LiuJiaChang</a> <a class="main-nav-link switch-friends-link" href="http://blog.yusank.space">YusanKurban</a> <a class="main-nav-link switch-friends-link" href="https://blog.lizebang.top">Lizebang</a> <a class="main-nav-link switch-friends-link" href="https://github.com/sunanxiang">SunAnXiang</a> <a class="main-nav-link switch-friends-link" href="https://github.com/DoubleWoodH">LinHao</a> <a class="main-nav-link switch-friends-link" href="https://blog.littlechao.top">ShiChao</a> <a class="main-nav-link switch-friends-link" href="https://github.com/Txiaozhe">TangXiaoJi</a> <a class="main-nav-link switch-friends-link" href="https://github.com/LLLeon">JiaChenHui</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">不悲不喜，不卑不亢，努力成为一个更好的程序猿！</div></section></div></div></header></div></div><div class="hide-left-col" title="隐藏侧栏"><i class="fa fa-angle-double-left"></i></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">鱼の乐</a></h1></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="//src.wangriyu.wang/images/blog/avatar.jpg"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">鱼の乐</a></h1></hgroup><p class="header-subtitle">子非鱼，安知鱼之乐也！</p><nav class="header-menu"><ul><li><a href="//home.wangriyu.wang">主页</a></li><li><a href="/archives/">归档</a></li><li><a href="/pages/waterFallAlbum">相册</a></li><li><a href="/pages/resume">简历</a></li><li><a href="/tags/">标签云</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa 掘金" target="_blank" href="https://juejin.im/user/58c3744bda2f605609683d66" title="掘金"></a> <a class="fa GitHub" target="_blank" href="https://github.com/wangriyu" title="GitHub"></a> <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a> <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/clownduo/activities" title="知乎"></a> <a class="fa CSDN" target="_blank" href="https://blog.csdn.net/i929664292" title="CSDN"></a> <a class="fa jianshu" target="_blank" href="https://www.jianshu.com/u/7a8c5ba0b316" title="jianshu"></a> <a class="fa Facebook" target="_blank" href="https://www.facebook.com/riyu.wang.7" title="Facebook"></a> <a class="fa Twitter" target="_blank" href="https://twitter.com/wangriyu" title="Twitter"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="目标"></nav><div class="body-wrap"><article id="post-http-message" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2018/03-http-message.html" class="article-date"><time class="published" datetime="2018-03-14T16:00:00.000Z" itemprop="datePublished">2018-03-15 发布</time> <time class="updated" datetime="2018-07-29T04:27:21.000Z" itemprop="dateUpdated">2018-07-29 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name">HTTP Message</h1></header><div class="article-info article-info-post"><div class="article-count"><div class="article-category tagcloud"><a class="article-category-link" href="/categories/http/">http</a></div><div class="article-tag tagcloud"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http-扩展阅读/">http 扩展阅读</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络/">网络</a></li></ul></div><span class="post-count">总字数7,406</span> <span class="post-count">预计阅读28分钟</span></div><div class="clearfix"></div></div><div class="article-entry" itemprop="articleBody"><h2 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h2><p><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html" target="_blank" rel="noopener">RFC2616</a> 中定义的 HTTP Request 消息体结构：</p><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">Request</span> <span class="token operator">=</span> Request-Line             </span><span class="token comment" spellcheck="true">// 请求行</span>
          *<span class="token punctuation">(</span><span class="token punctuation">(</span> general-header       <span class="token comment" spellcheck="true">// 通用首部</span>
            | request-header       <span class="token comment" spellcheck="true">// 请求首部</span>
            | entity-header <span class="token punctuation">)</span>CRLF<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 实体首部</span>
          CRLF
          <span class="token punctuation">[</span> message-body <span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/request.png" title="image" data-fancybox="images" data-caption="request.png"><img data-original="https://src.wangriyu.wang/images/blog/http/request.png" src="/img/loading.gif" title="image" alt="image"></a></p><p>一个 HTTP 的 request 消息以一个请求行开始，从第二行开始是 headers (️每个键值对都以 CRLF 结尾)，接下来是一个 CRLF 开头的空行，表示 header 结束，最后是消息主体。</p><h3 id="请求行的定义如下"><a href="#请求行的定义如下" class="headerlink" title="请求行的定义如下:"></a>请求行的定义如下:</h3><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">Request-Line</span> <span class="token operator">=</span> Method SP Request-URI SP HTTP-Version CRLF</span>

<span class="token variable-declaration"><span class="token variable">Method</span> <span class="token operator">=</span> <span class="token string">"OPTIONS"</span> | <span class="token string">"GET"</span> | <span class="token string">"HEAD"</span> | <span class="token string">"POST"</span> | <span class="token string">"PUT"</span> | <span class="token string">"DELETE"</span> | <span class="token string">"TRACE"</span> | <span class="token string">"CONNECT"</span> | extension-method</span>

<span class="token variable-declaration"><span class="token variable">Request-URI</span> <span class="token operator">=</span> <span class="token string">"*"</span> | absoluteURI | abs_path | authotity（CONNECT）</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="请求方法（也叫请求动作）"><a href="#请求方法（也叫请求动作）" class="headerlink" title="请求方法（也叫请求动作）"></a>请求方法（也叫请求动作）</h3><ul><li>GET 请求会显示请求指定的资源。一般来说 GET 方法应该只用于数据的读取，而不应当用于会产生副作用的非幂等的操作中。GET 会方法请求指定的页面信息，并返回响应主体，GET 被认为是不安全的方法，因为 GET 方法会被网络蜘蛛等任意的访问。</li><li>HEAD 方法与 GET 方法一样，都是向服务器发出指定资源的请求。但是，服务器在响应 HEAD 请求时不会回传资源的内容部分，即：响应主体。这样，我们可以不传输全部内容的情况下，就可以获取服务器的响应头信息。HEAD 方法常被用于客户端查看服务器的性能。</li><li>POST 请求会向指定资源提交数据，请求服务器进行处理，如：表单数据提交、文件上传等，请求数据会被包含在请求体中。POST 方法是非幂等的方法，因为这个请求可能会创建新的资源或 / 和修改现有资源。</li><li>PUT 请求会身向指定资源位置上传其最新内容，PUT 方法是幂等的方法。通过该方法客户端可以将指定资源的最新数据传送给服务器取代指定的资源的内容。</li><li>DELETE 请求用于请求服务器删除所请求 URI 所标识的资源。DELETE 请求后指定资源会被删除，DELETE 方法也是幂等的。</li><li>CONNECT 方法是 HTTP/1.1 协议预留的，代表使用隧道协议 (Tunneling Protocol) 进行连接。通常用于 SSL/TLS 加密服务器的链接与非加密的 HTTP 代理服务器的通信。</li><li>OPTIONS 请求与 HEAD 类似，一般也是用于客户端查看服务器的性能。 这个方法会请求服务器返回该资源所支持的所有 HTTP 请求方法，该方法会用 ‘*’ 来代替资源名称，向服务器发送 OPTIONS 请求，可以测试服务器功能是否正常。JavaScript 的 XMLHttpRequest 对象进行 CORS 跨域资源共享时，就是使用 OPTIONS 方法发送嗅探请求，以判断是否有对指定资源的访问权限。</li><li>TRACE 请求服务器回显其收到的请求信息，该方法主要用于 HTTP 请求的测试或诊断。</li></ul><h3 id="请求地址"><a href="#请求地址" class="headerlink" title="请求地址"></a>请求地址</h3><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">Request-URI</span> <span class="token operator">=</span> <span class="token string">"*"</span> | absoluteURI | abs_path | authority（CONNECT）</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>“*“ 代表请求不指向特定的资源，而是服务器本身，且只在所使用的方法没必要应用到资源时允许。一个典型的例子是 <code>OPTIONS * HTTP/1.1</code></li><li>absoluteURI 绝对地址，比如 <code>GET http://www.w3.org/pub/WWW/TheProject.html HTTP/1.1</code>。只用于向代理服务器 (proxy) 发送请求</li><li>abs_path 相对路径，“/” 代表服务器根</li><li>只有 CONNECT 方法使用 authority 形式，由域名和可选端口组成的 URL，比如 <code>CONNECT developer.mozilla.org:80 HTTP/1.1</code></li></ul><blockquote><p>向一个代理服务器发送 HTTP 请求时，请求行中应该使用绝对路径的 URL。如果向目标服务器直接发送请求，则请求行中只会包含相对路径的 URL(完整 URL 的 path 部分)。<br>为了能在后续 http 版本中过渡，所有 http/1.1 服务器都应该能够处理 absoluteURI 形式的请求，即使客户端只会向代理发送这种形式的请求，详见 <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2" target="_blank" rel="noopener">https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.2</a></p></blockquote><p>HTTP/1.1 中 Host 和 Request-URI 一起作为 Request 消息接收者判断请求资源的条件, 确认主机资源的方法如下：</p><ul><li><p>如果 Request-URI 是绝对地址（absoluteURI），这时请求里的主机存在于 Request-URI 里。忽略任何出现在请求里 Host 头域值</p></li><li><p>假如 Request-URI 不是绝对地址（absoluteURI），并且请求包括一个 Host 头域，则主机由该 Host 头域值决定</p></li><li><p>假如由规则１或规则２定义的主机是一个无效的主机，则应当以一个 400（错误请求）错误消息返回</p></li></ul><blockquote><p>⚠️ HTTP/1.1 请求必须带 Host 头域，否则会报 bad request;</p></blockquote><blockquote><p>HTTP/1.0 不支持 Host 头域，因为 1.0 认为一个 ip 只绑定一个主机，通过 ip 就能确认主机，但后来一台服务器可以存在多个虚拟主机 (virtual host) 共用一个 ip 的情况，所以 1.1 添加 Host 头域显示指定主机。</p></blockquote><h3 id="URI-统一资源标识符，Uniform-Resource-Identifier"><a href="#URI-统一资源标识符，Uniform-Resource-Identifier" class="headerlink" title="URI(统一资源标识符，Uniform Resource Identifier)"></a>URI(统一资源标识符，Uniform Resource Identifier)</h3><p>URI 就是由某个协议方案表示的资源的定位标识符，这个协议可以使 http、https、ftp 等，比如：</p><pre class="line-numbers language-http"><code class="language-http"><span class="token header-name keyword">ftp:</span>//ftp.is.co.za/rfc/rfc1808.txt
<span class="token header-name keyword">http:</span>//www.ietf.org/rfc/rfc2396.txt
<span class="token header-name keyword">ldap:</span>//[2001:db8::7]/c=GB?objectClass?one
<span class="token header-name keyword">mailto:</span>John.Doe@example.com
<span class="token header-name keyword">news:</span>comp.infosystems.www.servers.unix
<span class="token header-name keyword">tel:</span>+1-816-555-1212 telnet://192.0.2.16:80/
<span class="token header-name keyword">urn:</span><span class="token header-name keyword">oasis:</span><span class="token header-name keyword">names:</span><span class="token header-name keyword">specification:</span><span class="token header-name keyword">docbook:</span><span class="token header-name keyword">dtd:</span><span class="token header-name keyword">xml:</span>4.1.2
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>绝对 URI 的格式应该是这样的:</p><hr><p><u>http</u>://<u>user:pass</u>@<u><a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a></u>:<u>80</u>/<u>dir/index.html</u>?<u>uid=1</u>#<u>ch1</u></p><p>协议:// 登录信息 @服务器地址: 端口号 / 文件路径? 查询字符串#片段标识符</p><hr><blockquote><p>与 URL(统一资源定位符，Universal Resource Locator) 和 URN(统一资源名，Uniform Resource Name) 的关系：</p></blockquote><blockquote><blockquote><p>URL 和 URN 是 URI 的两个子集，URI 唯一标识了文件资源对象 (类似身份证)，URN 标识资源名称，URL 标识资源地址</p></blockquote></blockquote><h2 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h2><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">Response</span> <span class="token operator">=</span> Status-Line             </span><span class="token comment" spellcheck="true">// 状态行</span>
           *<span class="token punctuation">(</span><span class="token punctuation">(</span> general-header      <span class="token comment" spellcheck="true">// 通用首部</span>
            | response-header      <span class="token comment" spellcheck="true">// 响应首部</span>
            | entity-header <span class="token punctuation">)</span>CRLF<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 实体首部</span>
           CRLF
           <span class="token punctuation">[</span> message-body <span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/response.png" title="image" data-fancybox="images" data-caption="response.png"><img data-original="https://src.wangriyu.wang/images/blog/http/response.png" src="/img/loading.gif" title="image" alt="image"></a></p><p>response 第一行是状态行，包含状态码 Status-Code，Reason-Phrase 是状态码的简单文本描述 (比如 200 - OK、404 - Not Found)</p><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">Status-Line</span> <span class="token operator">=</span> HTTP-Version SP Status-Code SP Reason-Phrase CRLF</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Status-Code:</p><ul><li>1xx: 信息性——收到请求，继续处理</li><li>2xx: 成功性——成功收到、理解并接受行动</li><li>3xx: 重定向——必须采取进一步行动来完成请求</li><li>4xx: 客户端错误——请求包含错误语法或不能完成</li><li>5xx: 服务器错误——服务器没有成功完成显然有效的请求</li></ul><h2 id="消息体"><a href="#消息体" class="headerlink" title="消息体"></a>消息体</h2><p>HTTP 消息的 message-body（如果存在）用于挟带与请求或响应相关联的 entity-body.<br>message-body 只有在应用了 transfer-coding 时，通过 Transfer-Encoding 头部域指出，与 entity-body 不同。</p><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">message-body</span> <span class="token operator">=</span> entity-body | <span class="token operator">&lt;</span>entity-body encoded as per Transfer-Encoding<span class="token operator">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="headers"><a href="#headers" class="headerlink" title="headers"></a>headers</h2><p>这里只列举了 2616 中提到的头部域，还有很多新添加的头部域，可以自行查找</p><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">general-header</span> <span class="token operator">=</span> Cache-Control      </span><span class="token comment" spellcheck="true">// 控制缓存的行为，比如 `private, max-age=0, no-cache`</span>
                | Connection        <span class="token comment" spellcheck="true">// 控制不再转发给代理的首部字段或者管理持久连接 (Keep-Alive 或者 close)</span>
                | Date              <span class="token comment" spellcheck="true">// 表明创建 HTTP 报文的日期和时间</span>
                | Pragma            <span class="token comment" spellcheck="true">// 唯一字段 `no-cache`，用于兼容 HTTP/1.1 之前的版本，客户端会要求所有的中间服务器不返回缓存的资源</span>
                | Trailer           <span class="token comment" spellcheck="true">// 事先说明在报文主体后记录了哪些首部字段。该首部字段可应用在 HTTP/1.1 版本分块传输编码</span>
                | Transfer-Encoding <span class="token comment" spellcheck="true">// 规定了传输报文主体时采用的编码方式，比如 `chunked`</span>
                | Upgrade           <span class="token comment" spellcheck="true">// 检测 HTTP 协议及其他协议是否可使用更高的 版本进行通信，其参数值可以用来指定一个完全不同的通信协议，使用首部字段 Upgrade 时，还需要额外指定 Connection:Upgrade</span>
                | Via               <span class="token comment" spellcheck="true">// 追踪客户端与服务器之间的请求和响应报文 的传输路径</span>
                | Warning           <span class="token comment" spellcheck="true">// 从 HTTP/1.0 的响应首部（Retry-After）演变过来的。该首部通常会告知用户一些与缓存相关的问题的警告，字段格式:`[警告码][警告的主机: 端口号]“[警告内容]”([日期时间])`</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">request-header</span> <span class="token operator">=</span> Accept               </span><span class="token comment" spellcheck="true">// 通知服务器，用户代理能够处理的媒体类型及媒体类型的相对优先级（可用权重 q=0~1 来表示相对优先级）。可使用 type/subtype 这种形式，一次指定多种媒体类型，支持通配符。例如 `text/html, text/plain, text/css, image/jpeg, video/mpeg, application/zip` 等</span>
                | Accept-Charset      <span class="token comment" spellcheck="true">// 通知服务器用户代理支持的字符集及字符集的相对优先顺序，可一次性指定多种字符集</span>
                | Accept-Encoding     <span class="token comment" spellcheck="true">// 告知服务器用户代理支持的内容编码及内容编码的优先级顺序。可一次性指定多种内容编码，例如: `gzip, compress, deflate, identity`</span>
                | Accept-Language     <span class="token comment" spellcheck="true">// 告知服务器用户代理能够处理的自然语言集及优先级顺序，例如: `zh-cn,zh;q=0.7,en-us,en;q=0.3` 优先返回中文版响应</span>
                | Authorization       <span class="token comment" spellcheck="true">// 告知服务器，用户代理的认证信息（证书值），例如: `Basic dWVub3NlbjpwYXNzd29yZA==`</span>
                | Expect              <span class="token comment" spellcheck="true">// 告知服务器，客户端期望出现的某种特定行为。因服务器无法理解客户端的期望作出回应而发生错误时，会返回状态码 417 Expectation Failed。</span>
                | From                <span class="token comment" spellcheck="true">// 告知服务器使用用户代理的用户的电子邮件地址</span>
                | Host                <span class="token comment" spellcheck="true">// Host 会告知服务器，请求的资源所处的互联网主机名和端口号</span>
                | If-Match            <span class="token comment" spellcheck="true">// 只有当 If-Match 的字段值跟资源的 ETag 值匹配一致时，服务器才会接受请求，否则返回状态码 412 Precondition Failed</span>
                | If-Modified-Since   <span class="token comment" spellcheck="true">// If-Modified-Since 字段指定的日期时间后，资源发生了更新，服务器才会接受请求，否则返回状态码 304 Not Modified</span>
                | If-None-Match       <span class="token comment" spellcheck="true">// If-None-Match 的字段值与 ETag 值不一致时，可处理该请求。与 If-Match 首部字段的作用相反</span>
                | If-Range            <span class="token comment" spellcheck="true">// 告知服务器若指定的 If-Range 字段值（ETag 值或者时间）和请求资源的 ETag 值或时间相一致时，则作为范围请求处理。反之，则返回全体资源。</span>
                | If-Unmodified-Since <span class="token comment" spellcheck="true">// 与 If-Modified-Since 的作用相反</span>
                | Max-Forwards        <span class="token comment" spellcheck="true">// 通过 TRACE 方法或 OPTIONS 方法，发送包含首部字段 Max-Forwards 的请求时，该字段以十进制整数形式指定可经过的服务器最大数目，服务器转发请求之前，Max-Forwards 的值减 1 后重新赋值。当服务器接收到 Max-Forwards 值为 0 的请求时，则不再进行转发，直接返回响应。</span>
                | Proxy-Authorization <span class="token comment" spellcheck="true">// 接收到从代理服务器发来的认证质询时，客户端会发送包含首部字段 Proxy-Authorization 的请求，以告知服务器认证所需要的信息。</span>
                | Range               <span class="token comment" spellcheck="true">// 对于只需获取部分资源的范围请求，包含首部字段 Range 即可告知服 务器资源的指定范围。例如: `bytes=5001-10000` 表示请求获取从第 5001 字节至第 10000 字节的资源。服务器会在处理请求之后返回 206 Partial Content 的响应。无法处理该范围请求时，则返回 200 OK 的响应及全部资源。</span>
                | Referer             <span class="token comment" spellcheck="true">// 告知服务器请求的原始资源的 URI。</span>
                | TE                  <span class="token comment" spellcheck="true">// 告知服务器客户端能够处理响应的传输编码方式及相对优先级。它和首部字段 Accept-Encoding 的功能很相像，但是用于传输编码。</span>
                | User-Agent          <span class="token comment" spellcheck="true">// 将创建请求的浏览器和用户代理名称等信息传达给服务器</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">response-header</span> <span class="token operator">=</span> Accept-Ranges      </span><span class="token comment" spellcheck="true">// 告知客户端服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。可处理范围请求时指定其为 bytes，反之则指定其为 none。</span>
                | Age                <span class="token comment" spellcheck="true">// 告知客户端，源服务器在多久前创建了响应。字段值的单位为秒。若创建该响应的服务器是缓存服务器，Age 值是指缓存后的响应再次发起认证到认证完成的时间值。代理创建响应时必须加上首部字段 Age。</span>
                | ETag               <span class="token comment" spellcheck="true">// 告知客户端实体标签 (Entity Tag)。它是一种可将资源以字符串形式做唯一性标识的方式。服务器会为每份资源分配对应的 ETag 值。有强弱之分，弱 Etag 以 'w/' 开头。</span>
                | Location           <span class="token comment" spellcheck="true">// 将响应接收方引导至某个与请求 URI 位置不同的资源。该字段会配合 3xx ：Redirection 的响应，提供重定向的 URI。</span>
                | Proxy-Authenticate <span class="token comment" spellcheck="true">// 由代理服务器所要求的认证信息发送给客户端。</span>
                | Retry-After        <span class="token comment" spellcheck="true">// 告知客户端应该在多久之后再次发送请求。主要配合状态码 503 Service Unavailable 响应，或 3xx Redirect 响应一起使用。字段值可以指定为具体的日期时间（Wed, 04 Jul 2012 06：34：24 GMT 等格式），也可以是创建响应后的秒数</span>
                | Server             <span class="token comment" spellcheck="true">// 告知客户端当前服务器上安装的 HTTP 服务器应用程序的信息。例如: `Apache/2.2.6 (Unix) PHP/5.2.5`</span>
                | Vary               <span class="token comment" spellcheck="true">// 可对缓存进行控制。源服务器会向代理服务器传达关于本地缓存使用方法的命令。</span>
                | WWW-Authenticate   <span class="token comment" spellcheck="true">// WWW-Authenticate 用于 HTTP 访问认证。它会告知客户端适用于访问请求 URI 所指定资源的认证方案（Basic 或是 Digest）和带参数提示的质询（challenge）</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">entity-header</span> <span class="token operator">=</span> Allow              </span><span class="token comment" spellcheck="true">// 服务端通知客户端能够支持 Request-URI 指定资源的所有 HTTP 方法。当服务器接收到不支持的 HTTP 方法时，会以状态码 405 Method Not Allowed 作为响应返回。与此同时，还会把所有能支持的 HTTP 方法写入首部字段 Allow 后返回</span>
                | Content-Encoding <span class="token comment" spellcheck="true">// 告知客户端服务器对实体的主体部分选用的内容编码方式，字段值参见 Accept-Encoding</span>
                | Content-Language <span class="token comment" spellcheck="true">// 会告知客户端，实体主体使用的自然语言，例如: `zh-CN`</span>
                | Content-Length   <span class="token comment" spellcheck="true">// 表明了实体主体部分的大小（单位是字节）。对实体主体进行内容编码传输时，不能再使用 Content-Length 首部字段</span>
                | Content-Location <span class="token comment" spellcheck="true">// 给出与报文主体部分相对应的 URI。和首部字段 Location 不同，Content-Location 表示的是报文主体返回资源对应的 URI。</span>
                | Content-MD5      <span class="token comment" spellcheck="true">// 客户端会对接收的报文主体执行相同的 MD5 算法，然后与首部字段 Content-MD5 的字段值比较，其目的在于检查报文主体在传输过程中是否保持完整，以及确认传输到达。无法检测出恶意篡改</span>
                | Content-Range    <span class="token comment" spellcheck="true">// 能告知客户端作为响应返回的实体的哪个部分符合范围请求。字段值以字节为单位，表示当前发送部分及整个实体大小。例如: `bytes 5001-10000/10000`</span>
                | Content-Type     <span class="token comment" spellcheck="true">// 说明了实体主体内对象的媒体类型。和首部字段 Accept 一样，字段值用 type/subtype 形式赋值。例如: `text/html; charset=UTF-8`</span>
                | Expires          <span class="token comment" spellcheck="true">// 将资源失效的日期告知客户端。当首部字段 Cache-Control 有指定 max-age 指令时，Cache-Control 优先级大于 Expires</span>
                | Last-Modified    <span class="token comment" spellcheck="true">// 指明资源最终修改的时间</span>
                | extension-header <span class="token comment" spellcheck="true">// 允许定义额外的 entity-header 域而不改变协议，但不能假设接收方认识这些域。接收方应该忽略未识别的头域，但透明代理必须转发它</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="强缓存和协商缓存"><a href="#强缓存和协商缓存" class="headerlink" title="强缓存和协商缓存"></a>强缓存和协商缓存</h3><h4 id="浏览器在加载资源的时，先根据-http-header-判断它是否命中强缓存"><a href="#浏览器在加载资源的时，先根据-http-header-判断它是否命中强缓存" class="headerlink" title="浏览器在加载资源的时，先根据 http header 判断它是否命中强缓存."></a>浏览器在加载资源的时，先根据 http header 判断它是否命中强缓存.</h4><ul><li>命中强缓存：浏览器直接从自己缓存中读取资源，不发送请求到服务器</li><li>不命中强缓存：浏览器发送一个请求到服务器，服务器根据资源携带的 http header 验证该资源是否命中协商缓存<ul><li>命中协商缓存：将请求返回，但不是返回该资源的数据，而是告诉浏览器可以直接从缓存中加载这个资源。</li><li>不命中协商缓存：服务器返回该资源数据</li></ul></li></ul><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/Intermediaries.png" title="image" data-fancybox="images" data-caption="Intermediaries.png"><img data-original="https://src.wangriyu.wang/images/blog/http/Intermediaries.png" src="/img/loading.gif" title="image" alt="image"></a></p><h4 id="强缓存"><a href="#强缓存" class="headerlink" title="强缓存"></a>强缓存</h4><p>-【Cache-Control、Expires】: Expires 指定一个过期的时间戳 (绝对时间)，Cache-Control 指定缓存行为 (比如 max-age=604800 代表有效期为七天，是相对时间)。一般用其中一个，如果两个同时出现，Cache-Control 优先级大于 Expires。</p><blockquote><p>Cache-Control 是 http/1.1 弥补 Expires 缺陷新加入的，增加了很多行为</p></blockquote><table><thead><tr><th>Cache-Control</th><th>description</th></tr></thead><tbody><tr><td>public</td><td>资源将被客户端和代理服务器缓存</td></tr><tr><td>private</td><td>资源仅被客户端缓存, 代理服务器不缓存</td></tr><tr><td>no-store</td><td>请求和响应都不缓存 (真正地不缓存)</td></tr><tr><td>no-cache</td><td>do-not-serve-from-cache-without-revalidation，响应实际上可以缓存在本地缓存区，只是在与原服务器进行新鲜度验证之前不能返回给客户端</td></tr><tr><td>max-age</td><td>缓存资源, 但是在指定时间 (单位为秒) 后缓存过期</td></tr><tr><td>s-maxage</td><td>同上, 依赖 public 设置, 覆盖 max-age, 且只在代理服务器上有效</td></tr><tr><td>max-stale</td><td>指定时间内, 即使缓存过时, 资源依然有效</td></tr><tr><td>min-fresh</td><td>缓存的资源至少要保持指定时间的新鲜期</td></tr><tr><td>must-revalidation / proxy-revalidation</td><td>如果缓存失效, 强制重新向服务器 (或代理) 发起验证 (使用 must-revalidate 指令会忽略请求的 max-stale 指令)</td></tr><tr><td>only-if-cached</td><td>仅仅返回已经缓存的资源, 不访问源服务器, 若无缓存则返回 504 Gateway Timeout</td></tr><tr><td>no-transform</td><td>强制要求代理服务器不要对资源进行转换, 禁止代理服务器对 Content-Encoding, Content-Range, Content-Type 字段的修改 (因此代理的 gzip 压缩将不被允许)</td></tr><tr><td>cache-extension token</td><td>通过 cache-extension 标记（token），可以扩展 Cache-Control 首部字段内的指令，如果缓存服务器不能理解这个新指令，就会直接忽略</td></tr></tbody></table><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/StrongCache.png" title="image" data-fancybox="images" data-caption="StrongCache.png"><img data-original="https://src.wangriyu.wang/images/blog/http/StrongCache.png" src="/img/loading.gif" title="image" alt="image"></a></p><p>在控制台中可以查看读取的是本地缓存还是向服务器拉取的资源:</p><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/hit%20cache.png" title="image" data-fancybox="images" data-caption="hit%20cache.png"><img data-original="https://src.wangriyu.wang/images/blog/http/hit%20cache.png" src="/img/loading.gif" title="image" alt="image"></a></p><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/no%20cache.png" title="image" data-fancybox="images" data-caption="no%20cache.png"><img data-original="https://src.wangriyu.wang/images/blog/http/no%20cache.png" src="/img/loading.gif" title="image" alt="image"></a></p><h4 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h4><p>-【Last-Modified、If-Modified-Since】: If-Modified-Since 就是上次请求返回的 Last-Modified，服务器再次收到资源请求时，根据浏览器传过来 If-Modified-Since 和资源在服务器上的最后修改时间判断资源是否有变化，如果有变化就正常返回资源内容。如果没有变化，就返回 304 Not Modified，不返回资源内容，不更新 Last-Modified。</p><p>-【ETag、If-None-Match】: 浏览器第一次跟服务器请求一个资源，服务器在返回这个资源的同时，在 respone 的 header 加上 ETag（服务器根据当前请求的资源生成的一个唯一标识），这个唯一标识是一个字符串，只要资源有变化这个串就不同，服务器再次收到资源请求时，根据资源生成一个新的 ETag 和浏览器传过来 If-None-Match 比较，如果这两个值相同就说明资源没有变化，否则就是有变化；如果没有变化，返回 304 和 ETag 不返回资源；如果有变化，返回资源。ETag 优先级比 Last-Modified 高</p><blockquote><p>⚠️</p><ul><li>在分布式部署的时候，多台机器的 Last-Modified 必须保持一致，否则协商缓存会出问题。</li><li>分布式部署，不同的机器生成的 ETag 都会不一样， 然后协商缓存就会出问题。【如果没有搞定 ETag 一致，就先关闭掉】</li><li>协商缓存需要配合强缓存使用 【不启动强缓存，协商缓存也就不起作用】</li></ul></blockquote><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/NegotiateCache.png" title="image" data-fancybox="images" data-caption="NegotiateCache.png"><img data-original="https://src.wangriyu.wang/images/blog/http/NegotiateCache.png" src="/img/loading.gif" title="image" alt="image"></a></p><blockquote><p>另外浏览器的刷新 (F5 / cmd + r) 和强刷 (Ctrl + F5 / shift + cmd +r / option + cmd + r(safari)):<br>普通刷新会使用协商缓存，忽略强缓存；强刷会忽略浏览器所有缓存（并且请求头会携带 Cache-Control:no-cache 和 Pragma:no-cache，用来通知所有中间节点忽略缓存）。<br>只有从地址栏或收藏夹输入网址、点击链接等情况下，浏览器才会使用强缓存。</p></blockquote><h4 id="强校验和弱校验"><a href="#强校验和弱校验" class="headerlink" title="强校验和弱校验"></a>强校验和弱校验</h4><p><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.3.3" target="_blank" rel="noopener">https://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.3.3</a></p><p><a href="https://zh.wikipedia.org/wiki/HTTP_ETag" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/HTTP_ETag</a></p><p>ETag 强校验表明资源的两个版本每个字节都是相同，并且请求头（如 Content-Language）也不能有改变。强校验允许缓存，以及字节请求部分响应合并。</p><p>ETag 弱校验表明资源的两个版本只需要语义上保持一致，忽略细微差别比如修改时间等，这意味着，他们是可以互换的，并且缓存的副本也可以被使用。因为不需要资源版本保持字节程度的相同，所以这种 ETag 不适合字节请求。如果 web 服务器要动态的生成响应，这时弱校验 ETag 比较合适。</p><p>比如使用弱验证类型，一个页面与另外一个页面只是在页脚显示的时间上有所不同，或者是展示的广告不相同，那么就会被认为是相同的。但是在使用强验证的情况下，二者是不同的。</p><p>Last-Modified 存在的问题，也是使用 Etag 的原因:</p><ul><li>一些文件也许会周期性的更改，但是他的内容并不改变 (仅仅改变的修改时间)，这个时候我们并不希望客户端认为这个文件被修改了，而重新 GET</li><li>有些文档可能被修改了，但所做的修改并不重要，不需要让所有缓存都重装数据 (比如对拼写和注释的修改)</li><li>某些文件修改非常频繁，比如在秒以下的时间内进行修改 (比如实时监控器)，If-Modified-Since 能检查到的粒度是秒级的，对于小于秒级的修改无法判断 (或者说 UNIX 记录 MTIME 只能精确到秒)</li><li>某些服务器不能精确的得到文件的最后修改时间；</li></ul><p>例子:</p><ul><li>强校验</li></ul><pre class="line-numbers language-http"><code class="language-http"><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Date:</span> Sat, 05 May 2018 11:28:26 GMT
<span class="token header-name keyword">ETag:</span> "aaa"
<span class="token header-name keyword">Server:</span> nginx/1.12.2
<span class="token header-name keyword">Content-Length:</span> 5
<span class="token header-name keyword">Content-Type:</span> text/html<span class="token text/html">

Hello
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>若添加了内容编码 <code>Content-Encoding: gzip</code> 后，ETag 便会改变</p><pre class="line-numbers language-http"><code class="language-http"><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Date:</span> Sat, 05 May 2018 11:28:26 GMT
<span class="token header-name keyword">ETag:</span> "bbb"
<span class="token header-name keyword">Server:</span> nginx/1.12.2
<span class="token header-name keyword">Content-Length:</span> 5
<span class="token header-name keyword">Content-Type:</span> text/html
<span class="token header-name keyword">Content-Encoding:</span> gzip<span class="token text/html">

Hello
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>弱检验</li></ul><pre class="line-numbers language-http"><code class="language-http"><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Date:</span> Sat, 05 May 2018 11:28:26 GMT
<span class="token header-name keyword">ETag:</span> W/"ccc"
<span class="token header-name keyword">Server:</span> nginx/1.12.2
<span class="token header-name keyword">Content-Type:</span> text/css

.absolute-center {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>若 CSS 样式做了 minify，ETag 并不会改变，因为内容并没有发生实际变化</p><pre class="line-numbers language-http"><code class="language-http"><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Date:</span> Sat, 05 May 2018 11:28:26 GMT
<span class="token header-name keyword">ETag:</span> W/"ccc"
<span class="token header-name keyword">Server:</span> nginx/1.12.2
<span class="token header-name keyword">Content-Type:</span> text/css

.absolute-center{position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>此时客户端发起 <code>If-None-Match</code> 请求，服务端还是会响应 304 Not Modified，客户端继续读取之前未 minify 的缓存</p><h4 id="其他字段"><a href="#其他字段" class="headerlink" title="其他字段"></a>其他字段</h4><ul><li>Age: 告知客户端，源服务器在多久前创建了响应。若创建该响应的服务器是缓存服务器，Age 值是指缓存后的响应已过时间</li></ul><pre class="line-numbers language-http"><code class="language-http"><span class="token header-name keyword">Age:</span>2383321
<span class="token header-name keyword">Date:</span>Wed, 08 Mar 2017 16:12:42 GMT
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>代理服务器在 2017 年 3 月 8 日 16:12:42 时向源服务器发起了对该资源的请求, 目前已缓存了该资源 2383321 秒</p><ul><li>Vary: 从代理服务器接收到源服务器返回包含 Vary 指定项的响应之后，若再要进行缓存，仅对请求中含有相同 Vary 指定首部字段的请求返回缓存。即使对相同资源发起请求，但由于 Vary 指定的首部字段不相同，必须要从源服务器重新获取资源。</li></ul><pre class="line-numbers language-http"><code class="language-http"><span class="token header-name keyword">Vary:</span>Accept-Encoding,User-Agent
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>代理服务器将针对是否压缩和浏览器类型去缓存资源. 对于同一个 url, 就能针对 PC 和 Mobile 返回不同的缓存内容</p><ul><li>Pragma: <code>Pragma: no-cache</code> 是 http/1.1 之前的遗留版本，作用与 <code>Cache-Control: no-cache</code> 一样</li></ul><h3 id="CDN-缓存"><a href="#CDN-缓存" class="headerlink" title="CDN 缓存"></a>CDN 缓存</h3><p>CDN 的全称是 Content Delivery Network，即内容分发网络。将网站的内容发布到最接近用户的网络 “ 边缘 “ 的节点，使用户可以就近取得所需的内容，提高用户访问网站的响应速度</p><p>CDN 缓存，也叫网关缓存、反向代理缓存。浏览器先向 CDN 网关发起 WEB 请求，网关服务器后面对应着一台或多台负载均衡源服务器，会根据它们的负载请求，动态地请求转发到合适的源服务器上<br>当客户端向 CDN 节点请求数据时，CDN 节点会判断缓存数据是否过期，若缓存数据并没有过期，则直接将缓存数据返回给客户端；否则，CDN 节点就会向源站发出回源请求（back to the source request），从源站拉取最新数据，更新本地缓存，并将最新数据返回给客户端。</p><p>CDN 服务商一般会提供基于文件后缀、目录多个维度来指定 CDN 缓存时间，为用户提供更精细化的缓存管理。</p><p>CDN 缓存时间会对“回源率”产生直接的影响。若 CDN 缓存时间较短，CDN 边缘节点上的数据会经常失效，导致频繁回源，增加了源站的负载，同时也增大的访问延时；若 CDN 缓存时间太长，会带来数据更新时间慢的问题。开发者需要增对特定的业务，来做特定的数据缓存时间管理。</p><p>优点:</p><ul><li>CDN 节点解决了跨运营商和跨地域访问的问题，访问延时大大降低；</li><li>大部分请求在 CDN 边缘节点完成，CDN 起到了分流作用，减轻了源站的负载。</li></ul><h2 id="chunked-response"><a href="#chunked-response" class="headerlink" title="chunked response"></a>chunked response</h2><p>HTTP 1.1 默认使用的是持久连接 (Persistent Connection)，当服务器返回一个响应时连接不会关闭，如果未申明 <code>Connection: close</code> 关闭长连接，客户端会一直处于 pending 状态。</p><p>要让客户端知道这个响应到哪里结束主要有两种方式:</p><ol><li><p>在响应头上加上 <code>Content-Length</code> 显示申明实体 body 的长度，此时客户端便知道读到哪里结束，但是如果 <code>Content-Length</code> 长度短于实体长度，则内容会被截取；如果超过实体长度，客户端还是会 pending 等待后续缺省的数据。</p></li><li><p>HTTP 1.1 协议在 header 中引入 <code>Transfer-Encoding</code>，当其值为 <code>chunked</code> 时, 表明采用分块编码方式来进行报文体的传输。基本方法是将大块数据分解成多块小数据，每块都可以自定长度。</p></li></ol><p><strong>分块传输的优点:</strong></p><ul><li>HTTP 分块传输编码允许服务器为动态生成的内容以维持 HTTP 持久链接</li><li>分块传输编码允许服务器在最后发送消息头字段。对于那些头字段值在内容被生成之前无法知道的情形非常重要，例如消息的内容要使用散列进行签名，散列的结果通过 HTTP 消息头字段进行传输。没有分块传输编码时，服务器必须缓冲内容直到完成后计算头字段的值并在发送内容前发送这些头字段的值。</li><li>HTTP 服务器有时使用压缩 （gzip 或 deflate）以缩短传输花费的时间。分块传输编码可以用来分隔压缩对象的多个部分。在这种情况下，块不是分别压缩的，而是整个负载进行压缩，压缩的输出使用本文描述的方案进行分块传输。在压缩的情形中，分块编码有利于一边进行压缩一边发送数据，而不是先完成压缩过程以得知压缩后数据的大小。</li></ul><p><strong>格式:</strong></p><p>每一个非空的块都以该块包含数据的字节数（字节数以十六进制表示）开始，跟随一个 CRLF，然后是数据本身，最后 CRLF 结束。</p><p>最后一块是单行，由块大小（0），一些可选的填充空格，以及 CRLF。最后一块不再包含任何数据，但是可以发送可选的尾部，包括消息头字段。</p><p>消息最后以 CRLF 结尾。</p><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token variable-declaration"><span class="token variable">Chunked-Body</span>   <span class="token operator">=</span> <span class="token operator">*</span>chunk</span>
                 last-chunk
                 trailer
                 CRLF

<span class="token variable-declaration"><span class="token variable">chunk</span>          <span class="token operator">=</span> chunk-size <span class="token punctuation">[</span> chunk-extension <span class="token punctuation">]</span> CRLF</span>
                 <span class="token property-declaration"><span class="token property">chunk-data</span> CRLF</span>

<span class="token variable-declaration"><span class="token variable">chunk-size</span>     <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">*</span>HEX</span>

<span class="token variable-declaration"><span class="token variable">last-chunk</span>     <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span> <span class="token punctuation">[</span> chunk-extension <span class="token punctuation">]</span> CRLF</span>

<span class="token variable-declaration"><span class="token variable">chunk-extension=</span> <span class="token operator">*</span><span class="token punctuation">(</span> <span class="token string">";"</span> chunk-ext-name <span class="token punctuation">[</span> <span class="token string">"="</span> chunk-ext-val <span class="token punctuation">]</span> <span class="token punctuation">)</span></span>
<span class="token variable-declaration"><span class="token variable">chunk-ext-name</span> <span class="token operator">=</span> token</span>
<span class="token variable-declaration"><span class="token variable">chunk-ext-val</span>  <span class="token operator">=</span> token | quoted-string</span>
<span class="token variable-declaration"><span class="token variable">chunk-data</span>     <span class="token operator">=</span> <span class="token func"><span class="token function">chunk-size</span><span class="token punctuation">(</span>OCTET<span class="token punctuation">)</span></span></span>

<span class="token variable-declaration"><span class="token variable">trailer</span>        <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>entity-header CRLF<span class="token punctuation">)</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>例子:</p><pre class="line-numbers language-http"><code class="language-http"><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Content-Type:</span> text/plain
<span class="token header-name keyword">Transfer-Encoding:</span> chunked

25

This is the data in the first chunk

1C

and this is the second one

3

con

8

sequence

0


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token string">"This is the data in the first chunk\r\n"</span>      <span class="token punctuation">(</span>37 字符 => 十六进制<span class="token punctuation">:</span> 0x25<span class="token punctuation">)</span>
<span class="token string">"and this is the second one\r\n"</span>               <span class="token punctuation">(</span>28 字符 => 十六进制<span class="token punctuation">:</span> 0x1C<span class="token punctuation">)</span>
<span class="token string">"con"</span>                                          <span class="token punctuation">(</span>3  字符 => 十六进制<span class="token punctuation">:</span> 0x03<span class="token punctuation">)</span>
<span class="token string">"sequence"</span>                                     <span class="token punctuation">(</span>8  字符 => 十六进制<span class="token punctuation">:</span> 0x08<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>最后以 “0\r\n\r\n” 结束</p><p>解码数据</p><pre class="line-numbers language-stylus"><code class="language-stylus"><span class="token property-declaration"><span class="token property">This</span> <span class="token operator">is</span> the data <span class="token operator">in</span> the first chunk</span>
<span class="token property-declaration"><span class="token property">and</span> this <span class="token operator">is</span> the second one</span>
consequence
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>实际抓包数据:</p><p><a class="fancy-ctn" href="https://src.wangriyu.wang/images/blog/http/chunked.png" title="image" data-fancybox="images" data-caption="chunked.png"><img data-original="https://src.wangriyu.wang/images/blog/http/chunked.png" src="/img/loading.gif" title="image" alt="image"></a></p><p>首部字段 <code>Trailer</code> 会事先说明在报文主体后记录了哪些首部字段，比如</p><pre class="line-numbers language-http"><code class="language-http"><span class="token response-status">HTTP/1.1 <span class="token property">200 OK</span></span>
<span class="token header-name keyword">Date:</span> Tue, 03 Jul 2012 04:40:56 GMT
<span class="token header-name keyword">Content-Type:</span> text/html
...
<span class="token header-name keyword">Transfer-Encoding:</span> chunked
<span class="token header-name keyword">Trailer:</span> Expires<span class="token text/html">

...(报文主体)...

0

Expires: Tue, 28 Sep 2004 23:59:59 GMT

</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>请求首部字段 <code>TE</code> 告知服务器 客户端能够处理响应的传输编码方式及相对优先级</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html" target="_blank" rel="noopener">RFC2616</a></li><li><a href="https://zh.wikipedia.org/wiki/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E6%A0%87%E5%BF%97%E7%AC%A6" target="_blank" rel="noopener">wikipedia uri</a></li><li>《图解 HTTP》</li><li><a href="https://zh.wikipedia.org/wiki/%E5%88%86%E5%9D%97%E4%BC%A0%E8%BE%93%E7%BC%96%E7%A0%81" target="_blank" rel="noopener">Chunked transfer encoding - 分块传输编码 wiki</a></li><li><a href="https://tools.ietf.org/html/rfc2616#section-3.6.1" target="_blank" rel="noopener">RFC 2616 - Chunked Transfer Coding</a></li><li><a href="https://github.com/amandakelake/blog/issues/41" target="_blank" rel="noopener">缓存机制</a></li><li><a href="https://notfalse.net/56/http-stale-response" target="_blank" rel="noopener">http cache</a></li><li><a href="http://imweb.io/topic/55c6f9bac222e3af6ce235b9" target="_blank" rel="noopener">缓存策略</a></li></ul></div></div><div class="copyright"><p><span>本文标题:</span><a href="/2018/03-http-message.html">HTTP Message</a></p><p><span>文章作者:</span><a href="/" title="回到主页">鱼の乐</a></p><p><span>发布时间:</span>2018-03-15, 00:00:00</p><p><span>最后更新:</span>2018-07-29, 12:27:21</p><p><span>原始链接:</span><a class="post-url" href="/2018/03-http-message.html" title="HTTP Message">https://blog.wangriyu.wang/2018/03-http-message.html</a></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。</p></div><nav id="article-nav"><div id="article-nav-newer" class="article-nav-title"><a href="/2018/03-http-tls.html">SSL/TLS 详解</a></div><div id="article-nav-older" class="article-nav-title"><a href="/2018/03-valine.html">更换博客评论系统</a></div></nav></article><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Request"><span class="toc-text">Request</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#请求行的定义如下"><span class="toc-text">请求行的定义如下:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#请求方法（也叫请求动作）"><span class="toc-text">请求方法（也叫请求动作）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#请求地址"><span class="toc-text">请求地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URI-统一资源标识符，Uniform-Resource-Identifier"><span class="toc-text">URI(统一资源标识符，Uniform Resource Identifier)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Response"><span class="toc-text">Response</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#消息体"><span class="toc-text">消息体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#headers"><span class="toc-text">headers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#强缓存和协商缓存"><span class="toc-text">强缓存和协商缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#浏览器在加载资源的时，先根据-http-header-判断它是否命中强缓存"><span class="toc-text">浏览器在加载资源的时，先根据 http header 判断它是否命中强缓存.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#强缓存"><span class="toc-text">强缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#协商缓存"><span class="toc-text">协商缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#强校验和弱校验"><span class="toc-text">强校验和弱校验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其他字段"><span class="toc-text">其他字段</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CDN-缓存"><span class="toc-text">CDN 缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chunked-response"><span class="toc-text">chunked response</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-text">References</span></a></li></ol></div><style>.left-col .switch-area,.left-col .switch-btn{display:none}.toc-level-6 i,.toc-level-6 ol{display:none!important}</style><input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录"><script>yiliaConfig.toc=["隐藏目录","显示目录",!0],$(".left-col").is(":hidden")&&$("#tocButton").attr("value",yiliaConfig.toc[1])</script><div class="share"><link rel="stylesheet" type="text/css" href="/share/iconfont.css"><link rel="stylesheet" href="/share/spongebob.min.css" type="text/css" media="all"><div class="social_share"><ul id="social_list" class="social_icon_list"></ul></div><script>var shareConfig={title:"HTTP Message",url:window.location.href,author:"鱼の乐",img:"https://src.wangriyu.wang/images/blog/avatar.jpg"}</script><script src="/share/qrcode.min.js"></script><script src="/share/spongebob.min.js"></script></div><section id="comments" style="margin:30px;padding:2em;background:rgba(255,255,255,.5)"><link rel="stylesheet" href="//src.wangriyu.wang/lib/gitalk/gitalk.min.css"><script src="//src.wangriyu.wang/lib/gitalk/gitalk.min.js"></script><div id="gitalk-container"></div><script type="text/javascript">var gitalk=new Gitalk({clientID:"f7029005e9b4b35463e1",clientSecret:"62c9e6339c73778f29fd10eea90ea5aeb4f15427",repo:"wangriyu.github.io",owner:"wangriyu",admin:["wangriyu"],id:window.location.pathname});gitalk.render("gitalk-container")</script></section><div class="scroll" id="post-nav-button"><a href="/2018/03-http-tls.html" title="上一篇: SSL/TLS 详解"><i class="fa fa-angle-left"></i> </a><a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a> <a href="/2018/03-valine.html" title="下一篇: 更换博客评论系统"><i class="fa fa-angle-right"></i></a></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04-Golang-GC.html">学习 Golang GC</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02-fix-memory-leak.html">记一次 pprof 分析解决 golang 项目内存泄漏的过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01-docker-grafana.html">Grafana 企业微信报警</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08-Jenkins.html">Jenkins + Ansible 实现 Golang 自动化编译部署</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08-ELK.html">从零开始搭建一套日志收集分析系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08-Linux_libc.html">解决 Linux “GLIBCXX_* not found” 问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07-root.html">Mac 系统如何解锁、root、刷 Android 手机</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06-Distribution.html">分布式相关理论和分布式事务</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06-share.html">浏览器的 Copy 事件</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06-Hash.html">数据结构 - 哈希</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06-Tree.html">数据结构 - 树</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06-Aplayer.html">使用 Aplayer 导致博客目录跳转失效</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05-server-nextcloud.html">搭建 docker 环境并用 docker 部署 nextcloud 网盘</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05-server-ftp.html">CentOS 搭建 FTP 服务</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05-HTTP2.html">HTTP2 详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05-server-git.html">博客搬家</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04-go-http.html">Golang http/server</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04-go-rpc.html">Golang RPC</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04-http-pki.html">PKI 体系</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03-http-tls.html">SSL/TLS 详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03-http-message.html">HTTP Message</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03-valine.html">更换博客评论系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01-githubpage.html">GithubPages 绑定二级域名并开启 HTTPS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12-Dart V.html">Dart 语法入门 V</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12-MacStorageExpansion.html">极具性价比的 Mac 存储扩展方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12-Win+Ubuntu.html">UEFI + GPT + Win10 + Ubuntu + rEFInd</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12-Dart IV.html">Dart 语法入门 IV</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11-masm.html">masm for mac</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11-Dart III.html">Dart 语法入门 III</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10-Dart II.html">Dart 语法入门 II</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10-MacSkills.html">Mac 快速入门操作指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10-Dart I.html">Dart 语法入门 I</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09-ShareArtifact.html">分享自用的一些软件、插件、网站和应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08-Hexo.html">使用 Hexo 主题 Yelee</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08-Storage.html">浏览器本地存储</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08-SystemIO.html">系统 I/O</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06-JSNote3.html">0611-JS 笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05-JSNote2.html">0507-JS 笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04-JSNote1.html">0423-JS 笔记</a></li></ul><script></script></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"><i class="fa fa-copyright"></i> 2017-2020 <a href="http://www.beian.miit.gov.cn" title="备案信息" target="_blank">冀ICP备18010769号</a></div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访人数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span> </span></span><span>| </span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本页访问次数"><i class="fa fa-eye" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span></span></span></div><div class="footer-right"><i class="fa fa-heart"></i><a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架"> Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a></div></div></div></footer></div><script type="application/javascript">var leftWidth,hide=!1;$(".hide-left-col").click(function(){hide?($(".left-col").css("width",leftWidth),$(".left-col .intrude-less").fadeIn(200),$("#tocButton").fadeIn(200),"block"===$("#switch-btn").css("display")&&"block"===$("#switch-area").css("display")||$("#toc").fadeIn(200),$(".hide-left-col").css("left",leftWidth).html('<i class="fa fa-angle-double-left"></i>'),$(".mid-col").css("left",leftWidth),$("#post-nav-button").css("left",leftWidth),$("#post-nav-button > a:nth-child(2)").css("display","block"),hide=!1):(leftWidth=$(".left-col")[0].style.width,$(".left-col").css("width",0),$(".left-col .intrude-less").fadeOut(200),$("#toc").fadeOut(100),$("#tocButton").fadeOut(100),$(".hide-left-col").css("left",0).html('<i class="fa fa-angle-double-right"></i>'),$(".mid-col").css("left",0),$("#post-nav-button").css("left",0),$("#post-nav-button > a:nth-child(2)").css("display","none"),$(".post-list").is(":visible")&&($("#post-nav-button .fa-bars,#post-nav-button .fa-times").toggle(),$(".post-list").toggle()),hide=!0)})</script><script data-main="/js/main.js" src="//src.wangriyu.wang/lib/requirejs/require.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106179639-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-106179639-1")</script><script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[["$$","$$"],["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){var a,e=MathJax.Hub.getAllJax();for(a=0;a<e.length;a+=1)e[a].SourceElement().parentNode.className+=" has-jax"})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a> <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a> <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={post:".copyright a[href]",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script>var titleTime,originTitle=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(つェ⊂)"+originTitle,clearTimeout(titleTime)):(document.title="(*´∇｀*)~ "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))})</script><script async src="https://src.wangriyu.wang/lib/busuanzi/busuanzi.pure.mini.js"></script></div><link href="//src.wangriyu.wang/lib/aos/aos.css" rel="stylesheet"><script type="text/javascript">AOS.init({easing:"ease-out-back",once:!0})</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/assets/izumi.model.json"},"display":{"position":"right","width":100,"height":200,"hOffset":-50,"vOffset":-85},"mobile":{"show":false},"react":{"opacityDefault":0.9,"opacityOnHover":0.3},"pluginJsPath":"lib/","pluginModelPath":"assets/"});</script><script>!function(o){var l=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;function n(){for(var t=0,e=l.length;t<e;t++)n=l[t],void 0,0<=(i=n.getBoundingClientRect()).top&&0<=i.left&&i.top<=(o.innerHeight||document.documentElement.clientHeight)&&(l[t].src=l[t].getAttribute("data-original"),l.splice(t,1),e=l.length,t--);var n,i}n(),o.addEventListener("scroll",function(){var t,e;t=n,e=o,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)},!1)}(this);</script></body>