var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];var shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function BlurStack(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}function processImageDataRGB(d,D,C,a,R,g){var L=d.data;var J,I,P,O,o,u,l,e,f,B,n,t,z,r,K,q,k,s,v,F;var Q=g+g+1;var G=a<<2;var m=a-1;var N=R-1;var j=g+1;var M=j*(j+1)/2;var E=new BlurStack();var A=E;for(P=1;P<Q;P++){A=A.next=new BlurStack();if(P==j){var h=A}}A.next=E;var b=null;var H=null;l=u=0;var w=mul_table[g];var c=shg_table[g];for(I=0;I<R;I++){r=K=q=e=f=B=0;n=j*(k=L[u]);t=j*(s=L[u+1]);z=j*(v=L[u+2]);e+=M*k;f+=M*s;B+=M*v;A=E;for(P=0;P<j;P++){A.r=k;A.g=s;A.b=v;A=A.next}for(P=1;P<j;P++){O=u+((m<P?m:P)<<2);e+=(A.r=(k=L[O]))*(F=j-P);f+=(A.g=(s=L[O+1]))*F;B+=(A.b=(v=L[O+2]))*F;r+=k;K+=s;q+=v;A=A.next}b=E;H=h;for(J=0;J<a;J++){L[u]=(e*w)>>c;L[u+1]=(f*w)>>c;L[u+2]=(B*w)>>c;e-=n;f-=t;B-=z;n-=b.r;t-=b.g;z-=b.b;O=(l+((O=J+g+1)<m?O:m))<<2;r+=(b.r=L[O]);K+=(b.g=L[O+1]);q+=(b.b=L[O+2]);e+=r;f+=K;B+=q;b=b.next;n+=(k=H.r);t+=(s=H.g);z+=(v=H.b);r-=k;K-=s;q-=v;H=H.next;u+=4}l+=a}for(J=0;J<a;J++){K=q=r=f=B=e=0;u=J<<2;n=j*(k=L[u]);t=j*(s=L[u+1]);z=j*(v=L[u+2]);e+=M*k;f+=M*s;B+=M*v;A=E;for(P=0;P<j;P++){A.r=k;A.g=s;A.b=v;A=A.next}o=a;for(P=1;P<=g;P++){u=(o+J)<<2;e+=(A.r=(k=L[u]))*(F=j-P);f+=(A.g=(s=L[u+1]))*F;B+=(A.b=(v=L[u+2]))*F;r+=k;K+=s;q+=v;A=A.next;if(P<N){o+=a}}u=J;b=E;H=h;for(I=0;I<R;I++){O=u<<2;L[O]=(e*w)>>c;L[O+1]=(f*w)>>c;L[O+2]=(B*w)>>c;e-=n;f-=t;B-=z;n-=b.r;t-=b.g;z-=b.b;O=(J+(((O=I+j)<N?O:N)*a))<<2;e+=(r+=(b.r=L[O]));f+=(K+=(b.g=L[O+1]));B+=(q+=(b.b=L[O+2]));b=b.next;n+=(k=H.r);t+=(s=H.g);z+=(v=H.b);r-=k;K-=s;q-=v;H=H.next;u+=a}}return d}(function(){function a(m,w){var B={image:"",rippleRadius:3,width:480,height:480,delay:1,auto:true};if(w!==undefined){for(var b in w){if(w.hasOwnProperty(b)&&B.hasOwnProperty(b)){B[b]=w[b]}}}if(!B.image.length){return false}var r;var C=B.delay*1000;var f;var v=B.width;var D=B.height;var k=v/2;var i=D/2;var t=v*(D+2)*2;var F=v;var u=v*(D+3);var e=0;var s=B.rippleRadius;var j=[];var d=[];var o;var E;var x;var g;var l=document.createElement("div");l.style.width=v+"px";l.style.height=D+"px";m.appendChild(l);var h=document.createElement("canvas");h.id="ripple_canvas";h.width=v;h.height=D;l.appendChild(h);var z=h.getContext("2d");z.fillStyle="#ECECEC";z.fillRect(0,0,v,D);function c(){r=new Image();r.onload=function(){A()};r.src=B.image}function n(){z.drawImage(r,0,0);E=z.getImageData(0,0,v,D);o=z.getImageData(0,0,v,D);processImageDataRGB(o,0,0,v,D,3);processImageDataRGB(E,0,0,v,D,3);x=o.data;g=E.data}function A(){n();for(var G=0;G<t;G++){d[G]=j[G]=0}y();if(B.auto){f=setInterval(function(){q(Math.random()*v,Math.random()*D)},C);q(Math.random()*v,Math.random()*D)}}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(G){window.setTimeout(G,1000/60)}})();function y(){requestAnimFrame(y);p()}function p(){var I;I=F;F=u;u=I;I=0;e=F;for(var M=0;M<D;M++){for(var N=0;N<v;N++){var J=(j[e-v]+j[e+v]+j[e-1]+j[e+1])>>1;J-=j[u+I];J-=J>>5;j[u+I]=J;J=1024-J;var H=d[I];d[I]=J;if(H!=J){var O=(((N-k)*J/1024)<<0)+k;var L=(((M-i)*J/1024)<<0)+i;if(O>=v){O=v-1}if(O<0){O=0}if(L>=D){L=D-1}if(L<0){L=0}var K=(O+(L*v))*4;var G=I*4;x[G]=g[K];x[G+1]=g[K+1];x[G+2]=g[K+2]}++e;++I}}z.putImageData(o,0,0)}function q(J,H){J<<=0;H<<=0;for(var K=H-s,L=H+s;K<L;K++){for(var I=J-s,G=J+s;I<G;I++){j[F+(K*v)+I]+=512}}}this.disturb=function(H,G){q(H,G)};c()}window.WaterRippleEffect=a})();
